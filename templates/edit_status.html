{% extends "dashboardlayout.html" %}

{% block head %}
    <title>Edit Status</title>
{% endblock %}

{% block body %}
<div class="d-flex flex-column">
    <h1 class="p-2">Edit Status</h1>
    <form id="editStatusForm" method="POST" action="/edit_status/{{ status_to_edit.id }}" class="p-2" onsubmit="return validateEditStatusForm()">
        {{ form.hidden_tag() }} <!-- Include CSRF token -->
        <div class="form-group">
            <label for="status">Status:</label>
            {{ form.status(class="form-control", id="status") }}
        </div>
        <div class="form-group">
            <label for="reason">Reason:</label>
            {{ form.reason(class="form-control", id="reason", placeholder="Reason") }}
        </div>
        <button class="btn btn-primary" type="submit">Update Status</button>
    </form>
</div>

<script src="{{ url_for('static', filename='validation.js') }}"></script>
<script>
function validateEditStatusForm() {
    var status = document.getElementById("status").value;
    var reason = document.getElementById("reason").value;

    // Regular expressions for validation
    var statusRegex = /^[a-zA-Z0-9\s\-.,!?()'"\\/]+$/; // Alphanumeric characters, spaces, and common punctuation
    var reasonRegex = /^[a-zA-Z0-9\s\-.,!?()'"\\/]+$/; // Alphanumeric characters, spaces, and common punctuation

    // Check if inputs match the patterns
    if (!statusRegex.test(status)) {
        alert("Status contains invalid characters");
        return false;
    }
    if (!reasonRegex.test(reason)) {
        alert("Reason contains invalid characters");
        return false;
    }

    return true; // Return true if validation passes, false otherwise
}
</script>
{% endblock %}